import os
import pandas as pd

# Path to the folder containing Excel files
folder_path = "/path/to/your/folder"

# Read the replacement data from "replace.xlsx"
replace_df = pd.read_excel("replace.xlsx")

# Iterate through all Excel files in the folder
for filename in os.listdir(folder_path):
    if filename.endswith(".xlsx"):
        file_path = os.path.join(folder_path, filename)
        df = pd.read_excel(file_path)

        # Perform find-and-replace based on columns 'a' and 'b'
        for index, row in replace_df.iterrows():
            find_word = row['a']
            replace_word = row['b']
            df.replace(find_word, replace_word, inplace=True)

        # Save the modified DataFrame back to the same file
        df.to_excel(file_path, index=False)

print("Find-and-replace completed for all Excel files in the folder.")
